<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Vista de lista heredada para stock.quant con campos de mármol -->
    <record id="stock_quant_list_view_marble" model="ir.ui.view">
        <field name="name">stock.quant.list.marble</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.view_stock_quant_tree_editable"/>
        <field name="arch" type="xml">
            
            <!-- Agregar campo para condiciones -->
            <xpath expr="//field[@name='product_id']" position="after">
                <field name="is_marble_product" column_invisible="1"/>
            </xpath>
            
            <!-- Agregar campos de mármol después del producto -->
            <xpath expr="//field[@name='product_categ_id']" position="after">
                
                <field name="marble_serial_number" 
                       string="Nº Serie" 
                       optional="show"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_status" 
                       string="Estado Mármol" 
                       optional="show"
                       widget="badge"
                       decoration-success="marble_status == 'available'"
                       decoration-info="marble_status == 'reserved'"
                       decoration-warning="marble_status == 'draft'"
                       decoration-danger="marble_status == 'damaged'"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_height" 
                       string="Alto (cm)" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_width" 
                       string="Ancho (cm)" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_thickness" 
                       string="Grosor (cm)" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_sqm" 
                       string="M²" 
                       optional="show"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_custom_lot" 
                       string="Lote" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="wooden_crate_code" 
                       string="Código Atado" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_origin" 
                       string="Origen" 
                       optional="hide"
                       invisible="not is_marble_product"/>
                       
                <field name="marble_finish" 
                       string="Acabado" 
                       optional="hide"
                       invisible="not is_marble_product"/>
            </xpath>
            
        </field>
    </record>

    <!-- Vista de búsqueda heredada para filtros de mármol -->
    <record id="stock_quant_search_view_marble" model="ir.ui.view">
        <field name="name">stock.quant.search.marble</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.quant_search_view"/>
        <field name="arch" type="xml">
            
            <!-- Agregar filtros específicos para mármol después de 'reserved' -->
            <xpath expr="//filter[@name='reserved']" position="after">
                <separator/>
                <filter string="Productos de Mármol" 
                        name="marble_products" 
                        domain="[('is_marble_product', '=', True)]"/>
                <filter string="Mármol Disponible" 
                        name="marble_available" 
                        domain="[('is_marble_product', '=', True), ('marble_status', '=', 'available')]"/>
                <filter string="Mármol Vendido" 
                        name="marble_sold" 
                        domain="[('is_marble_product', '=', True), ('marble_status', '=', 'sold')]"/>
                <filter string="Mármol en Stock" 
                        name="marble_with_stock" 
                        domain="[('is_marble_product', '=', True), ('quantity', '>', 0)]"/>
                <filter string="Mármol Dañado" 
                        name="marble_damaged" 
                        domain="[('is_marble_product', '=', True), ('marble_status', '=', 'damaged')]"/>
            </xpath>
            
            <!-- Agregar campos de búsqueda después de 'owner_id' -->
            <xpath expr="//field[@name='owner_id']" position="after">
                <field name="marble_serial_number" 
                       string="Nº Serie Mármol"
                       filter_domain="[('marble_serial_number', 'ilike', self)]"/>
                <field name="marble_custom_lot" 
                       string="Lote Mármol"
                       filter_domain="[('marble_custom_lot', 'ilike', self)]"/>
                <field name="wooden_crate_code" 
                       string="Código Atado"
                       filter_domain="[('wooden_crate_code', 'ilike', self)]"/>
                <field name="marble_origin" 
                       string="Origen Mármol"
                       filter_domain="[('marble_origin', 'ilike', self)]"/>
                <field name="marble_status" 
                       string="Estado Mármol"/>
            </xpath>
            
            <!-- Agregar agrupadores después de 'company' -->
            <xpath expr="//filter[@name='company']" position="after">
                <separator/>
                <filter string="Estado de Mármol" 
                        name="group_marble_status" 
                        context="{'group_by': 'marble_status'}"
                        domain="[('is_marble_product', '=', True)]"/>
                <filter string="Lote de Mármol" 
                        name="group_marble_lot" 
                        context="{'group_by': 'marble_custom_lot'}"
                        domain="[('is_marble_product', '=', True)]"/>
                <filter string="Origen de Mármol" 
                        name="group_marble_origin" 
                        context="{'group_by': 'marble_origin'}"
                        domain="[('is_marble_product', '=', True)]"/>
                <filter string="Código de Atado" 
                        name="group_wooden_crate" 
                        context="{'group_by': 'wooden_crate_code'}"
                        domain="[('is_marble_product', '=', True)]"/>
            </xpath>
            
        </field>
    </record>

</odoo>